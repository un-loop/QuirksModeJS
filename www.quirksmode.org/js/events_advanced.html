<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html lang="en">
<!-- Mirrored from www.quirksmode.org/js/events_advanced.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 22 Sep 2017 17:29:50 GMT -->
<head><title>Javascript - Advanced event registration models</title><link rel="stylesheet" href="../quirksmode.css" /><link rel="up" href="contents.html" /><link rel="intro" href="introevents.html" /><link rel="prev" href="events_tradmod.html" /><link rel="next" href="events_access.html" /><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><script type="text/javascript" src="../quirksmode.js"></script></head><body><h2>Advanced event registration models</h2><div id="header"></div><div class="floater"><p>See section 7C of <a href="https://www.quirksmode.org/book/">the book</a>.</p><p>The W3C model is supported by Mozilla, Safari, Konqueror, and iCab.</p><p>The Microsoft model is supported by Explorer 5+ on Windows.</p><p>Opera supports both models.</p></div><p class="intro">On this page I explain the two advanced event registration models:W3C&#8217;s and Microsoft&#8217;s. Since neither is cross&#8211;browser supported,their use is, for the moment, deprecated.</p><p>W3C and Microsoft have both developed their own event registration modelto replace Netscape&#8217;s<a href="events_tradmod.html">traditional model</a>. Though I&#8217;m notimpressed by the Microsoft model, W3C&#8217;s is very good, except for one<a href="http://evolt.org/article/Mission_Impossible_mouse_position/17/23335/index.html" class="external"	title="Evolt article: Mission impossible - mouse position">crucial vagueness</a>.Unfortunately few browsers support it at the moment.</p><h3>W3C</h3><p>W3C&#8217;s<a href="http://www.w3.org/TR/2000/REC-DOM-Level-2-Events-20001113/"	class="external">DOM Level 2 Event specification</a> pays careful attentionto the problems of the traditional model. It offers a simple way to register as many event handlersas you like for the same event on one element.</p><p>The key to the W3C event registration model is the method <code>addEventListener()</code>. You give it threearguments: the event type, the function to be executed and a boolean(<code>true</code> or <code>false</code>) that I&#8217;ll explain later on.To register our well known <code>doSomething()</code> function to the <code>onclick</code> of an element you do:</p><pre>element.addEventListener('click',doSomething,false)</pre><p>The beauty of this model is that we can add as many event listeners as we want to theelement. If we take our example modules from the<a href="events_tradmod.html">traditional model</a> page,we&#8217;d register them both as follows:</p><pre>element.addEventListener('click',startDragDrop,false)element.addEventListener('click',spyOnUser,false)</pre><p>and both event handlers fire when the user clicks on the element. Please note that the W3Cmodel does not state which event handler is fired first, so you cannot assume <code>startDragDrop()</code>is executed before <code>spyOnUser()</code>.</p><p>To remove an event handler, use the <code>removeEventListener()</code> method. You can choose whichhandler to remove, so</p><pre>element.removeEventListener('click',spyOnUser,false)</pre><p>removes the second event handler but leaves the first one untouched. Beautiful functionality, andit exactly solves the problem with the traditional model we noted before.</p><h4>Anonymous functions</h4><p>You can also use anonymous functions in the W3C model:</p><pre>element.addEventListener('click',function () {	this.style.backgroundColor = '#cc0000'},false)</pre><h4>true or false</h4><p>As to the <code>true</code> or <code>false</code> that is the last argument of <code>addEventListener</code>,it is meant to state whether the event handler should be executed<a href="events_order.html">in the capturing or in the bubbling phase</a>.If you&#8217;re not certain whether you want capturing or bubbling, use <code>false</code> (bubbling).</p><h4>this</h4><p>In JavaScript the <code>this</code> keyword always refers to the &#8220;owner&#8221; ofa function. In the case of event handlers it is very useful if <code>this</code> refers tothe HTML element the event is handled by, so that you have easy access to it.</p><p>Unfortunately the <code>this</code> keyword, though very powerful, is hard to use if you don&#8217;t knowexactly how it works. I discuss its use on<a href="this.html">another page</a>.</p><p>In the W3C model it works the same as in the<a href="events_tradmod.html">traditional model</a>: it refers to the HTMLelement currently handling the event.</p><pre>element.addEventListener('click',doSomething,false);another_element.addEventListener('click',doSomething,false);function doSomething() {	this.style.backgroundColor = '#cc0000';}</pre><p>If you register <code>doSomething()</code> as the <code>click</code> event handler of any HTML element,that element gets a red background whenever the user clicks on it. </p><h4>Which event handlers are registered?</h4><p>One problem of the current implementation of W3C&#8217;s event registration model isthat you can&#8217;t find out if any event handlers are already registered to an element. In the traditional modelyou could do:</p><pre>alert(element.onclick)</pre><p>and you see the function that&#8217;s registered to it, or <code>undefined</code> if nothing is registered.Only in its very recent<a href="http://www.w3.org/TR/2002/WD-DOM-Level-3-Events-20020208/changes.html"	title="Changes between DOM Level 3 Events and Level 2; published 8 Feb. 2002"	class="external"	>DOM Level 3 Events</a> W3C adds an <code>eventListenerList</code> to store a list of event handlersthat are currently registered on an element. This functionality is not yet supported by anybrowser, it&#8217;s too new. However, the problem has been addressed.</p><p>Fortunately <code>removeEventListener()</code> doesn&#8217;t give any errors if the event listener you want toremove has not been added to the element, so when in doubt you can always use <code>removeEventListener()</code>.</p><h3>Microsoft</h3><p>Microsoft, too, has developed an event registration model. It lookssimilar to W3C&#8217;s, but has some important drawbacks.</p><p>To register an event handler, <code>attach</code> it to the element:</p><pre>element.attachEvent('onclick',doSomething)</pre><p>or, if you need two event handlers:</p><pre>element.attachEvent('onclick',startDragDrop)element.attachEvent('onclick',spyOnUser)</pre><p>Removing one is simple, too:</p><pre>element.detachEvent('onclick',spyOnUser)</pre><h4>Drawbacks</h4><p>When compared to the W3C model, the Microsoft model has two important drawbacks:</p><ol><li>Events always bubble, no capturing possibility.</li><li>The event handling function is referenced, not copied, so<a href="this.html">the <code>this</code> keyword</a>always refers to the window and is completely useless.</li></ol><p>The result of these two weaknesses is that when an event bubbles upit is impossible to know which HTML element currently handles the event.I explain this problem more fully on the<a href="events_order.html">Event order</a> page.</p><p>Since the Microsoft event adding model is only supported by Explorer 5 and higher on Windows,it cannot be used for cross&#8211;browser scripts. But even for Explorer&#8211;on&#8211;Windows onlyapplications it&#8217;s best not to use it, since the bubbling problem can be quite nasty incomplex applications.</p><h3>Continue</h3><p>If you wish to go through all event pages in order, you should now continue with the<a href="events_access.html">Event accessing</a> page.</p><div id="footer"><a href="https://www.quirksmode.org/home.html">Home</a> <a href="https://www.quirksmode.org/sitemap.html">Sitemap</a><p class="smaller" id="validation">Valid XHTML 1.0</p></div></body>
<!-- Mirrored from www.quirksmode.org/js/events_advanced.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 22 Sep 2017 17:29:50 GMT -->
</html>