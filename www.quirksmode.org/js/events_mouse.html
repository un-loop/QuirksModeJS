<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html lang="en">
<!-- Mirrored from www.quirksmode.org/js/events_mouse.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 22 Sep 2017 17:29:50 GMT -->
<head><title>Javascript - Mouse Events</title><link rel="stylesheet" href="../quirksmode.css" /><link rel="up" href="contents.html" /><link rel="intro" href="introevents.html" /><link rel="prev" href="events_order.html" /><script type="text/javascript" src="../quirksmode.js"></script><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /></head><body><h2>Mouse Events</h2><div id="header"></div><div class="floater"><p>See sections 7B and 7H of <a href="https://www.quirksmode.org/book/">the book</a>.</p></div><p class="intro">The mouse events are by far the most important events. On this page I introduce some of the most common problemsand tricks.</p><p id="toc">We&#8217;ll go through all mouse events:<a href="#click" class="page">mousedown, mouseup and click</a>,<a href="#dblclick" class="page">dblclick</a>,<a href="#mousemove" class="page">mousemove</a> and finally<a href="#mouseover" class="page">mouseover and mouseout</a>. Then I explain the<a href="#relatedtarget" class="page">relatedTarget, fromElement and toElement</a> eventproperties. Finally the Microsoft proprietary<a href="#mouseenter" class="page">mouseenter and mouseleave</a> events.</p><p>For browser compatibility, see the<a href="events_compinfo.html">Event Compatibility Tables</a> page.</p><h3>Example</h3><p>Here&#8217;s a small example. Try it to better understand the explanations below.<br />Mousedown, mouseup, click and dblclick are registered to the link.You&#8217;ll see the events that take place in the textarea, or in an alert, if youso choose.</p><p><a href="javascript:void(null)" class="page"	onmousedown="logIt('mousedown')"	onmouseup="logIt('mouseup')"	onclick="logIt('click')"	ondblclick="logIt('dblclick')"		>The event handlers are registered on this link</a>.<br /><a href="#"  class="page"	onclick="document.forms['testform'].elements[1].value =''; return false">Clear textarea</a>.</p><script type="text/javascript">function logIt(evt) {	if (document.forms['testform'].elements[0].checked) alert(evt);	else document.forms['testform'].elements[1].value += evt + '\n';}</script><form name="testform" action="#"><p><input type="checkbox" name="al" />Show alert instead of writing to textarea<br /><textarea rows="6" cols="20"></textarea></p></form><h3 id="click">Mousedown, mouseup, click</h3><p>If the user clicks on an element no less than three mouse events fire, inthis order:</p><ol><li><code>mousedown</code>, user depresses the mouse button on this element</li><li><code>mouseup</code>, user releases the mouse button on this element</li><li><code>click</code>, one <code>mousedown</code> and one <code>mouseup</code> detectedon this element</li></ol><p>In general <code>mousedown</code> and <code>mouseup</code> are more useful than<code>click</code>. Some browsers don&#8217;t allow you to read out mouse button information<code>onclick</code>.Furthermore, sometimes the user does something with his mouse but no <code>click</code>event follows.</p><p>Suppose the user depresses the mouse button on a link, then moves his mouse off the linkand then releases the mouse button. Now the link only registers a <code>mousedown</code>event. Similarly, if the user depresses the mouse button, then moves the mouse over a linkand then releases the mouse button, the link only registers a <code>mouseup</code>. In neithercase does a <code>click</code> event fire.</p><p>Whether or not this is a problem depends on the user interaction you want. Butyou should generally register your script <code>onmousedown/up</code>,unless you&#8217;re completely sure you want the <code>click</code> event and nothing else.</p><p>If you use alerts in handling these events, the browser may lose track of which eventtook place on which element and how many times it took place, messing up your scripts. So it&#8217;sbest not to use alerts.</p><h3 id="dblclick">Dblclick</h3><p>The <code>dblclick</code> event is rarely used. Even when you use it,you should be sure <em>never</em> to register both an <code>onclick</code> and an <code>ondblclick</code>event handler on the same HTML element. Finding out what the user has actually done is nearly impossibleif you register both.</p><p>After all, when the user double&#8211;clicks on anelement one <code>click</code> event takes place before the <code>dblclick</code>. Besides,in Netscape the second <code>click</code> event is also separately handled before the<code>dblclick</code>. Finally, alerts are dangerous here, too.</p><p>So keep your <code>click</code>s and <code>dblclick</code>s well separated to avoidcomplications.</p><h3 id="mousemove">Mousemove</h3><p>The <code>mousemove</code> event works fine, but you should be awarethat it may take quite some system time to process all mousemove events. If the usermoves the mouse one pixel, the <code>mousemove</code> event fires. Even whennothing actually happens, long and complicated functions take time and thismay affect the usability of the site: everything goes very slowly, especially on old computers.</p><p>Therefore it&#8217;s best to register an <code>onmousemove</code> event handler only whenyou need it and to remove it as soon as it&#8217;s not needed any more:</p><pre>element.onmousemove = doSomething;// laterelement.onmousemove = null;</pre><h3 id="mouseover">Mouseover and mouseout</h3><p>Take another look at the <a href="eventexample.html" type="popup">example</a>, switch the mouseovers on and try them.The example adds an <code>onmouseover</code> event handler to <code>ev3</code> only. However,you&#8217;ll notice that a mouseover event takes place not only when the mouse enters<code>ev3</code>'s area, but also when it enters the area of <code>ev4</code> or the<code>span</code>. In Mozilla before 1.3, the event even fires when the mouse enters the area of a text!</p><p>The reason for this is of course<a href="events_order.html">event bubbling</a>. The user causes a<code>mouseover</code> event on <code>ev4</code>. There is no <code>onmouseover</code>event handler on this element, but there is one on <code>ev3</code>. As soon as the eventhas bubbled up to this element, the event handler is executed.</p><p>Now this setup, though completely correct, gives us some problems.Our first problem is targeting. Suppose the mouse enters <code>ev4</code>:</p><pre>-----------------------------------------| This is div id="ev3"                  ||   -----------------------------       ||   | This is div id="ev4"      |       ||   | --------              &lt;--------   ||   | | span |                  |       ||   | |      |                  |       ||   | --------                  |       ||   -----------------------------       |-----------------------------------------&lt;--------: mouse movement</pre><p>Now the <code>target/srcElement</code> of this event is <code>ev4</code>: it&#8217;s theelement the event took place on, since the user mouses over it. But when this happens:</p><pre>-----------------------------------------| This is div id="ev3"                  ||   -----------------------------       ||   | This is div id="ev4"      |       ||   | --------                  |       ||   | | span |                  |       ||   | |    --------&gt;            |       ||   | --------                  |       ||   -----------------------------       |-------------------------------------------------&gt;: mouse movement</pre><p>the event has exactly the same <code>target/srcElement</code>. Here, too, the mouse enters<code>ev4</code>. Nonetheless you might want do one thing when the mouse comes from<code>ev3</code> and another thing when it comes from the SPAN. So we need to know wherethe mouse comes from.</p><h3 id="relatedtarget">relatedTarget, fromElement, toElement</h3><p>W3C added the <code>relatedTarget</code> property to mouseover and mouseoutevents. This contains the element the mouse came from in case of <code>mouseover</code>, orthe element it goes to in case of <code>mouseout</code>.</p><p>Microsoft created two properties to contain this information:</p><ul><li><code>fromElement</code> refers to the element the mouse comes from. This is interestingto know in case of mouseover.</li><li><code>toElement</code> refers to the element the mouse goes to. This is interestingto know in case of mouseout.</li></ul><p>In our first example, <code>relatedTarget/fromElement</code> contains a reference to<code>ev3</code>, in our second example to the SPAN. Now you know where the mouse came from.</p><h3>Cross&#8211;browser scripts</h3><p>So if you want to know where the mouse comes from in case of <code>mouseover</code>, do:</p><pre>function doSomething(e) {	if (!e) var e = window.event;	var relTarg = e.relatedTarget || e.fromElement;}</pre><p>If you want to know where the mouse goes to in case of <code>mouseout</code>, do:</p><pre>function doSomething(e) {	if (!e) var e = window.event;	var relTarg = e.relatedTarget || e.toElement;}</pre><h3>Mousing out of a layer</h3><p>In a layer-based navigation you may need to know when the mouseleaves a layer so that it can be closed. Therefore you register an <code>onmouseout</code> eventhandler to the layer. However, event bubbling causes this event handler to fire when the mouseleaves any element inside the layer, too.</p><pre>--------------| Layer      |.onmouseout = doSomething;| --------   || | Link | ----&gt; We want to know about this mouseout| |      |   || --------   || --------   || | Link |   || |    ----&gt; | but not about this one| --------   |------------------&gt;: mouse movement</pre><p>Another show stopper is that when you move the mouse into the layer, and then onto a link,browsers register a mouseout event on the layer! It doesn't make much sense to me (the mouse isstill in the layer), but all browsers agree on this one.</p><p>So how do we reject any mouseout that does not take place when the mouse actually leaves thelayer?</p><pre>function doSomething(e) {	if (!e) var e = window.event;	var tg = (window.event) ? e.srcElement : e.target;	if (tg.nodeName != 'DIV') return;	var reltg = (e.relatedTarget) ? e.relatedTarget : e.toElement;	while (reltg != tg && reltg.nodeName != 'BODY')		reltg= reltg.parentNode	if (reltg== tg) return;	// Mouseout took place when mouse actually left layer	// Handle event}</pre><p>First get the event target, ie. the element the mouse moved out of.If the target is not the DIV (layer), end the function immediately, sincethe mouse has certainly <em>not</em> left the layer.</p><p>If the target <em>is</em> the layer, we're still not sure if the mouse left the layer or entereda link within the layer. Therefore we're going to check the <code>relatedTarget</code>/<code>toElement</code>of the event, ie. the element the mouse moved to.</p><p>We read out this element, and then we're going to move upwards through the DOM tree until we eitherencounter the <code>target</code> of the event (ie. the DIV), or the <code>body</code> element.</p><p>If we encounter the <code>target</code> the mouse moves towards a child element of the layer, so themouse has not actually left the layer. We stop the function.</p><p>When the function has survived all these checks we're certain that the mouse has actually left thelayer and we can take appropriate action (usually making the layer invisible).</p><h3 id="mouseenter">Mouseenter and mouseleave</h3><p><a href="http://msdn.microsoft.com/library/default.asp?url=/workshop/author/dhtml/reference/events.asp"		title="List of MS events" class="external"		>Microsoft</a> has another solution. It has created two new events <code>mouseenter</code>and <code>mouseleave</code>. They are almost the same as mouseover and mouseout except thatthey don&#8217;t react to event bubbling. Thereforethey see the entire HTML element they&#8217;re registered to as one solid block and don&#8217;treact to mouseovers and &#8211;outs taking place inside the block.</p><p>So using these events solves our problem too: they react only to mouseovers/outs on theelement they&#8217;re registered to.</p><p>At the moment these events are only supported by Explorer 5.5 on Windows and higher.Maybe the other browser vendors will copy these events.</p><h3>End</h3><p>You have now reached the end of my Introduction to Events. Good luck in writing your ownevent handling scripts.</p><div id="footer"><a href="https://www.quirksmode.org/home.html">Home</a> <a href="https://www.quirksmode.org/sitemap.html">Sitemap</a><p class="smaller" id="validation">Valid XHTML 1.0</p></div></body>
<!-- Mirrored from www.quirksmode.org/js/events_mouse.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 22 Sep 2017 17:29:51 GMT -->
</html>