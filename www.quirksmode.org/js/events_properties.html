<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html lang="en">
<!-- Mirrored from www.quirksmode.org/js/events_properties.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 22 Sep 2017 17:29:50 GMT -->
<head><title>Javascript - Event properties</title><link rel="stylesheet" href="../quirksmode.css" /><link rel="up" href="contents.html" /><link rel="intro" href="introevents.html" /><link rel="prev" href="events_access.html" /><link rel="next" href="events_order.html" /><script type="text/javascript" src="../quirksmode.js"></script><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /></head><body><h2>Event properties</h2><div id="header"></div><div class="floater"><p>See section 7E and 7F of <a href="https://www.quirksmode.org/book/">the book</a>.</p><p>The <code>target/srcElement</code> properties are sometimes buggy in Explorer 5 on Macand unreliable in Netscape 4.</p></div><p class="intro">On this page I give some example scripts for reading out event properties. Thereare very serious browser incompatibilities in this area.</p><p id="toc"></p><p>As soon as we want to read out information about the event, we&#8217;re inundated byan immense amount of properties, most of which do not work in most browsers. See the<a href="events_compinfo.html">Event compatibility tables</a> for a quickoverview or the<a href="https://www.quirksmode.org/dom/w3c_events.html">W3C DOM Compatibility - Events</a> page for a completeoverview.</p><p>I am not going togive an alphabetical list of properties, since it wouldn&#8217;t help a bit to make you understandall this &#8212; the situation is too confusing.Instead I&#8217;ve written five scripts to ask five questions of the browser.</p><ol><li>What is the <a href="#type" class="page">type</a> of the event?</li><li>Which HTML element is the <a href="#target" class="page">target</a> of the event?</li><li>Which <a href="#key" class="page">key</a> was pressed during the event?</li><li>Which <a href="#button" class="page">mouse button</a> was pressed during the event?</li><li>What was the <a href="#position" class="page">mouse position</a> during the event?</li></ol><p>I answered the last question in great detail in a now outdated<a href="http://evolt.org/article/Mission_Impossible_mouse_position/17/23335/index.html"	class="external"	title="Mission impossible - mouse position">Evolt article</a>.</p><p>Please note that in these scripts I&#8217;ve been very strict in my object detection. Ifirst create cross-browser event access, then I check if the browser supports each individual propertybefore using it.</p><h3 id="type">What is the type of the event?</h3><p>This is the only question with a true cross-browser answer: use the <code>type</code> property toread out the type:</p><pre>function doSomething(e) {	if (!e) var e = window.event;	alert(e.type);}</pre><h3 id="target">Which HTML element is the target of the event?</h3><p>W3C/Netscape says: the <code>target</code>. No, says Microsoft, the <code>srcElement</code>.Both properties return the HTML element the event took place on. </p><pre>function doSomething(e) {	var targ;	if (!e) var e = window.event;	if (e.target) targ = e.target;	else if (e.srcElement) targ = e.srcElement;	if (targ.nodeType == 3) // defeat Safari bug		targ = targ.parentNode;}</pre><p>The last two lines of code are especially for Safari. Ifan event takes place on an element that contains text, this <em>text node</em>, and not the element, becomes thetarget of the event. Therefore we check if the target's <code>nodeType</code> is 3, a text node. If it is we moveto its parent node, the HTML element.</p><p>Even if an event <a href="events_order.html">is captured or bubbles up</a>,the target/srcElement always remains the element the event took place on.</p><h4>Other targets</h4><p>There are some more targeting properties. I discuss<code>currentTarget</code> on the<a href="events_order.html">Event order</a> pageand <code>relatedTarget</code>, <code>fromElement</code> and <code>toElement</code> on the<a href="events_mouse.html">Mouse events</a> page.</p><h3 id="key">Which key has been pressed?</h3><p>This one is relatively easy. First get the code of the key (a = 65)from the <code>keyCode</code> property.</p><p>When you&#8217;ve read out the key code, send it through the method<code>String.fromCharCode()</code> to obtain the actual key value, if necessary.</p><pre>function doSomething(e) {	var code;	if (!e) var e = window.event;	if (e.keyCode) code = e.keyCode;	else if (e.which) code = e.which;	var character = String.fromCharCode(code);	alert('Character was ' + character);}</pre><p>There are some subtleties that may make the key events hard to use. For instance, the<code>keypress</code> event fires as long as the user keeps the key pressed. However, in mostbrowsers the <code>keydown</code> event also keeps firing as long asthe key is pressed. I&#8217;m not sure this is a good idea, but it&#8217;s what happens.</p><h3 id="button">Which mouse button has been clicked?</h3><p>There are two properties for finding out which mousebutton has been clicked: <code>which</code> and <code>button</code>. Please note that theseproperties don&#8217;t always work on a <code>click</code> event. To safely detect a mousebutton you have to use the <code>mousedown</code> or <code>mouseup</code> events.</p><p><code>which</code> is an old Netscape property. Left button gives a value of 1, middle button(mouse wheel) gives 2, right button gives 3. No problems, except its meager support (and the factthat it&#8217;s also used for key detection).</p><p>Now <code>button</code> has been fouled up beyond all recognition. According toW3C its values should be:</p><ul><li>Left button &#8211; 0</li><li>Middle button &#8211; 1</li><li>Right button &#8211; 2</li></ul><p>According to Microsoft its values should be:</p><ul><li>Left button &#8211; 1</li><li>Middle button &#8211; 4</li><li>Right button &#8211; 2</li></ul><p>No doubt the Microsoft model is better than W3C&#8217;s.0 should mean &#8220;no button pressed&#8221;, anything else is illogical.</p><p>Besides, only in the Microsoft model button values can be combined, so that 5 would mean &#8220;leftand middle button&#8221;. Not even Explorer 6 actually supports this yet, but in the W3C modelsuch a combination is <em>theoretically impossible</em>: you cannever know whether the left button was also clicked.</p><p>In my opinion<a href="http://www.w3.org/TR/2000/REC-DOM-Level-2-Events-20001113/events.html#Events-eventgroupings-mouseevents"	title="DOM Level 2 Events specification" class="external"	>W3C</a> has made some serious mistakes in defining <code>button</code>.</p><h4>Right click</h4><p>Fortunately you most often want to know if the right button has been clicked. SinceW3C and Microsoft  happen to agree on this one and give<code>button</code> a value of 2, you can still detect a right click.</p><pre>function doSomething(e) {	var rightclick;	if (!e) var e = window.event;	if (e.which) rightclick = (e.which == 3);	else if (e.button) rightclick = (e.button == 2);	alert('Rightclick: ' + rightclick); // true or false}</pre><p>Please note that, although Macs have only one mouse button, Mozilla gives a Ctrl&#8211;Clicka <code>button</code> value of 2, since Ctrl&#8211;Click also brings up the context menu. iCab doesn&#8217;t yetsupport mouse button properties at all and you cannot yet detect a right&#8211;click in Opera.</p><h3 id="position">Mouse position</h3><p>As to the mouse position, the situation is horrible. Althoughthere are no less than six mouse coordinates property pairs, there is no reliable cross&#8211;browserway to find the mouse coordinates relative to the document we need.</p><p>These are the six property pairs &#8212; see also the<a href="events_compinfo.html" >Event compatibility tables</a> or the<a href="https://www.quirksmode.org/dom/w3c_events.html#mousepos">W3C DOM Compatibility - Events</a> page.</p><ol><li>clientX,clientY</li><li>layerX,layerY</li><li>offsetX,offsetY</li><li>pageX,pageY</li><li>screenX,screenY</li><li>x,y</li></ol><p>I explained the problem, W3C&#8217;s vagueness and the use of <code>pageX/Y</code> and<code>clientX/Y</code> in my slightly outdated<a href="http://evolt.org/article/Mission_Impossible_mouse_position/17/23335/index.html"	class="external"	title="Mission impossible - mouse position">Evolt article</a>.</p><p>The <code>screenX</code> and <code>screenY</code> properties are the only ones that are completelycross&#8211;browser compatible. They give the mouse position relative to the entire computer screenof the user. Unfortunately this information is completely useless: you never need to know themouse position relative to the screen &#8212; well, maybe only if you want to place another windowat the mouse position.</p><p>The other three property pairs are unimportant. See the<a href="https://www.quirksmode.org/dom/w3c_events.html#mousepos">W3C DOM Compatibility - Events</a> page for a description.</p><h4>Correct script</h4><p>This is the correct script for detecting the mouse coordinates:</p><pre>function doSomething(e) {	var posx = 0;	var posy = 0;	if (!e) var e = window.event;	if (e.pageX || e.pageY) 	{		posx = e.pageX;		posy = e.pageY;	}	else if (e.clientX || e.clientY) 	{		posx = e.clientX + document.body.scrollLeft			+ document.documentElement.scrollLeft;		posy = e.clientY + document.body.scrollTop			+ document.documentElement.scrollTop;	}	// posx and posy contain the mouse position relative to the document	// Do something with this information}</pre><h3>Continue</h3><p>If you wish to go through all event pages in order, you should now continue with the<a href="events_order.html">Event order</a> page.</p><div id="footer"><a href="https://www.quirksmode.org/home.html">Home</a> <a href="https://www.quirksmode.org/sitemap.html">Sitemap</a><p class="smaller" id="validation">Valid XHTML 1.0</p></div></body>
<!-- Mirrored from www.quirksmode.org/js/events_properties.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 22 Sep 2017 17:29:50 GMT -->
</html>